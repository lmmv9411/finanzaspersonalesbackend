import{r as i,w as M,a as C,b as f,A as y,S as m,c as p,o as h,d as t,e as x,f as k,v as $,u as d,i as A,F as w,g as D,h as S,M as B,n as b,t as u,j as E}from"./index-bX7dxC4V.js";const F=()=>{const r=i([]),o=i(""),n=i(""),c=i(""),l=async()=>{try{const a=await f.get(`${y}/movements/date?startDate=${n.value}&endDate=${c.value}`);r.value=a.data}catch(a){console.error("Error al cargar movimientos",a)}},g=async a=>{m.fire({title:"Eliminando...",allowOutsideClick:!1,didOpen:()=>{m.showLoading()}});try{await f.delete(`${y}/movements/${a}`),r.value=r.value.filter(s=>s.id!==a),m.fire({title:"Movimiento Eliminado",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}catch(s){console.error("Error al eliminar movimiento",s),m.fire({title:"Error al eliminar movimiento",icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}},v=function(){const a=new Date,s=a.getFullYear(),e=String(a.getMonth()+1).padStart(2,"0");n.value=`${s}-${e}-01`,c.value=new Date(s,e,0).toISOString().split("T")[0],o.value=`${s}-${e}`};return M(o,a=>{const[s,e]=a.split("-");n.value=`${s}-${e}-01 00:00:00`,c.value=new Date(s,e,0).toISOString().split("T")[0]+" 23:59:59",l()}),C(()=>{v(),l()}),{movements:r,fetchMovements:l,selectedMonth:o,deleteMovement:g}};function O(r,o){return h(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M13.488 2.513a1.75 1.75 0 0 0-2.475 0L6.75 6.774a2.75 2.75 0 0 0-.596.892l-.848 2.047a.75.75 0 0 0 .98.98l2.047-.848a2.75 2.75 0 0 0 .892-.596l4.261-4.262a1.75 1.75 0 0 0 0-2.474Z"}),t("path",{d:"M4.75 3.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V9A.75.75 0 0 1 14 9v2.25A2.75 2.75 0 0 1 11.25 14h-6.5A2.75 2.75 0 0 1 2 11.25v-6.5A2.75 2.75 0 0 1 4.75 2H7a.75.75 0 0 1 0 1.5H4.75Z"})])}function V(r,o){return h(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])}const Z={class:"shadow-md p-2 rounded dark:bg-gray-800 bg-slate-100 flex gap-2 dark:text-gray-300 items-start sm:flex-row sm:items-end sm:w-fit m-auto flex-wrap"},L={class:"flex-1"},H={class:"w-full max-w-4xl mx-auto p-4 overflow-x-auto"},I={class:"dark:text-white w-full table-auto border-collapse whitespace-nowrap"},P={class:"px-4 py-2"},T={class:"px-4 py-2"},N={class:"px-4 py-2"},R={class:"px-4 py-2"},j={class:"px-4 py-2 flex gap-2 justify-center"},U=["onClick"],z=["onClick"],q={__name:"Movements",setup(r){const o=i(!1),n=i({}),c=a=>{o.value=!0,n.value=a},{selectedMonth:l,movements:g,deleteMovement:v}=F();return(a,s)=>(h(),p(w,null,[s[4]||(s[4]=t("h2",{class:"mx-auto dark:text-white w-fit text-2xl font-semibold mt-4"},"Movimientos Registrados",-1)),t("div",Z,[t("div",L,[s[2]||(s[2]=t("label",{for:"selectedMonth",class:"block text-gray-700 dark:text-gray-300"},"Filtrar Mes",-1)),k(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>A(l)?l.value=e:null),type:"month",id:"selectedMonth",class:"p-2 border border-gray-300 dark:bg-gray-900 dark:border-gray-700 border-2 focus:border-gray-300 focus:outline-none focus:border-gray-500 transition-colors duration-300 rounded"},null,512),[[$,d(l)]])])]),t("div",H,[t("table",I,[s[3]||(s[3]=t("thead",null,[t("tr",{class:"border-b border-gray-400"},[t("th",{class:"px-4 py-2"},"Tipo"),t("th",{class:"px-4 py-2"},"Monto"),t("th",{class:"px-4 py-2"},"Descripción"),t("th",{class:"px-4 py-2"},"Categoría"),t("th",{class:"px-4 py-2"},"Fecha"),t("th",{class:"px-4 py-2"},"Acciones")])],-1)),t("tbody",null,[(h(!0),p(w,null,D(d(g),e=>(h(),p("tr",{key:e.id,class:"border-b border-gray-300"},[t("td",P,[t("span",{class:b(["font-bold",{"text-green-600":e.type==="ingreso","text-red-600":e.type!=="ingreso"}])},u(e.type),3)]),t("td",{class:b(["px-4 py-2",{"text-green-600":e.type==="ingreso","text-red-600":e.type!=="ingreso"}])},u(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(e.type==="gasto"?e.amount*-1:e.amount)),3),t("td",T,u(e.description),1),t("td",N,u(e.Category.name),1),t("td",R,u(new Date(e.createdAt).toLocaleString()),1),t("td",j,[t("button",{onClick:_=>c(e),class:"text-blue-500 hover:text-blue-700 cursor-pointer",title:"Editar movimiento"},[x(d(O),{class:"h-5 w-5"})],8,U),t("button",{onClick:_=>d(v)(e.id),class:"text-red-500 hover:text-red-700 ml-2 cursor-pointer",title:"Eliminar movimiento"},[x(d(V),{class:"h-5 w-5"})],8,z)])]))),128))])])]),x(B,{visible:o.value,onClose:s[1]||(s[1]=e=>o.value=!1)},{default:S(()=>[x(E,{isEdit:"true",data:n.value},null,8,["data"])]),_:1},8,["visible"])],64))}};export{q as default};
