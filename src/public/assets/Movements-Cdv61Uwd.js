import{c as m,o as h,a as t,r as p,k as b,d as M,x as w,b as f,e as C,v as k,u as d,y as B,F as y,z as $,w as D,n as v,t as u}from"./index-5brMnQfe.js";import{S as i,u as S,M as E,_ as A}from"./MovementForm-BoAaHPs9.js";import"./categoriesStore-D_L3auj5.js";function F(a,s){return h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M13.488 2.513a1.75 1.75 0 0 0-2.475 0L6.75 6.774a2.75 2.75 0 0 0-.596.892l-.848 2.047a.75.75 0 0 0 .98.98l2.047-.848a2.75 2.75 0 0 0 .892-.596l4.261-4.262a1.75 1.75 0 0 0 0-2.474Z"}),t("path",{d:"M4.75 3.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V9A.75.75 0 0 1 14 9v2.25A2.75 2.75 0 0 1 11.25 14h-6.5A2.75 2.75 0 0 1 2 11.25v-6.5A2.75 2.75 0 0 1 4.75 2H7a.75.75 0 0 1 0 1.5H4.75Z"})])}function O(a,s){return h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])}const T=()=>{const a=p([]),s=p(""),n=p(""),c=p(""),l=async()=>{try{const r=await w.get(`/movements/date?startDate=${n.value}&endDate=${c.value}`);a.value=r.data}catch(r){console.error("Error al cargar movimientos",r)}},x=async r=>{if(!(await i.fire({title:"Eliminar Movimiento?",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){i.fire({title:"No se eliminó!",icon:"info",timer:2e3,theme:"auto",toast:!0,position:"top",showConfirmButton:!1,timerProgressBar:!0});return}i.fire({title:"Eliminando...",allowOutsideClick:!1,didOpen:()=>{i.showLoading()}});try{await w.delete(`/movements/${r}`),a.value=a.value.filter(e=>e.id!==r),i.fire({title:"Movimiento Eliminado",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"})}catch(e){console.error("Error al eliminar movimiento",e),i.fire({title:"Error al eliminar movimiento",icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"})}},g=function(){const r=new Date,o=r.getFullYear(),e=String(r.getMonth()+1).padStart(2,"0");n.value=`${o}-${e}-01`,c.value=new Date(o,e,0).toISOString().split("T")[0],s.value=`${o}-${e}`};return b(s,r=>{const[o,e]=r.split("-");n.value=`${o}-${e}-01 00:00:00`,c.value=new Date(o,e,0).toISOString().split("T")[0]+" 23:59:59",l()}),M(()=>g()),{movements:a,fetchMovements:l,selectedMonth:s,deleteMovement:x}},V={class:"shadow-md p-4 rounded dark:bg-gray-800 bg-slate-100 flex gap-2 dark:text-gray-300 items-start sm:flex-row sm:items-end w-fit m-auto flex-wrap"},Z={class:"flex flex-row items-center gap-4"},H={class:"w-full max-w-4xl mx-auto p-4 overflow-x-auto"},L={class:"dark:text-white w-full table-auto border-collapse whitespace-nowrap"},N={class:"px-4 py-2"},P={class:"px-4 py-2"},I={class:"px-4 py-2"},z={class:"px-4 py-2"},R={class:"px-4 py-2 flex gap-2 justify-center"},j=["onClick"],U=["onClick"],J={__name:"Movements",setup(a){const s=S(),n=p({}),c=r=>{n.value=r,s.showModal=!0},{selectedMonth:l,movements:x,deleteMovement:g}=T();return(r,o)=>(h(),m(y,null,[o[3]||(o[3]=t("h2",{class:"mx-auto dark:text-white w-fit text-2xl font-semibold mt-4"},"Movimientos Registrados",-1)),t("div",V,[t("div",Z,[o[1]||(o[1]=t("label",{for:"selectedMonth",class:"block text-gray-700 dark:text-gray-300"},"Filtrar Mes",-1)),C(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>B(l)?l.value=e:null),type:"month",id:"selectedMonth",class:"p-2 border border-gray-300 dark:bg-gray-900 dark:border-gray-700 border-2 focus:border-gray-300 focus:outline-none focus:border-gray-500 transition-colors duration-300 rounded"},null,512),[[k,d(l)]])])]),t("div",H,[t("table",L,[o[2]||(o[2]=t("thead",null,[t("tr",{class:"border-b border-gray-400"},[t("th",{class:"px-4 py-2"},"Tipo"),t("th",{class:"px-4 py-2"},"Monto"),t("th",{class:"px-4 py-2"},"Descripción"),t("th",{class:"px-4 py-2"},"Categoría"),t("th",{class:"px-4 py-2"},"Fecha"),t("th",{class:"px-4 py-2"},"Acciones")])],-1)),t("tbody",null,[(h(!0),m(y,null,$(d(x),e=>(h(),m("tr",{key:e.id,class:"border-b border-gray-300"},[t("td",N,[t("span",{class:v(["font-bold",{"text-green-600":e.type==="ingreso","text-red-600":e.type!=="ingreso"}])},u(e.type),3)]),t("td",{class:v(["px-4 py-2",{"text-green-600":e.type==="ingreso","text-red-600":e.type!=="ingreso"}])},u(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(e.type==="gasto"?e.amount*-1:e.amount)),3),t("td",P,u(e.description),1),t("td",I,u(e.Category.name),1),t("td",z,u(new Date(e.createdAt).toLocaleString()),1),t("td",R,[t("button",{onClick:_=>c(e),class:"text-blue-500 hover:text-blue-700 cursor-pointer",title:"Editar movimiento"},[f(d(F),{class:"h-5 w-5"})],8,j),t("button",{onClick:_=>d(g)(e.id),class:"text-red-500 hover:text-red-700 ml-2 cursor-pointer",title:"Eliminar movimiento"},[f(d(O),{class:"h-5 w-5"})],8,U)])]))),128))])])]),f(E,null,{default:D(()=>[f(A,{isEdit:"true",data:n.value},null,8,["data"])]),_:1})],64))}};export{J as default};
