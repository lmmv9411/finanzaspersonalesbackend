import{c as w,o as h,a as r,h as D,l as x,S as d,L as R,M as E,t as y,u as t,J as F,N,b as i,I as U,w as C,G as A}from"./index-D20-CgTh.js";import{u as H,C as L}from"./movementStore-Bwm6-ljm.js";import{_ as V}from"./BaseButton-CN7Z6Vwp.js";import{_ as g}from"./BaseInput-C5t2AxFz.js";import{R as T,r as Z,a as q}from"./RadioButton-Bb2m8eZf.js";import"./iconify-D6A_XGjB.js";import"./categoriesStore-BoGzBli8.js";import"./icons-BjrsL8W4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./graphStore-ffSWiZGa.js";function G(n,u){return h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M10.47 2.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H5.75a.75.75 0 0 1 0-1.5h5.69l-.97-.97a.75.75 0 0 1 0-1.06Zm-4.94 6a.75.75 0 0 1 0 1.06l-.97.97h5.69a.75.75 0 0 1 0 1.5H4.56l.97.97a.75.75 0 1 1-1.06 1.06l-2.25-2.25a.75.75 0 0 1 0-1.06l2.25-2.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function O(n,u){return h(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z","clip-rule":"evenodd"})])}const P=()=>{const n=H(),u=async l=>{if(n.movement.amount=m.value.replace(/\D/g,""),l&&!(await d.fire({title:"¿Desea Editar Registro?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, Editar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){s(),d.fire({title:"Edicion Cancelada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"});return}d.fire({title:l?"Editando":"Guardando...",allowOutsideClick:!1,didOpen:()=>{d.showLoading()},theme:"auto"}),await n.saveMovement(l),d.close(),n.isSaved?d.fire({title:`Movimiento ${l?"Editado":"Registrado"}`,icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"}):d.fire({title:`Error al ${l?"Editar":"Registrar"} movimiento`,icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"}),l&&history.back(),s()},s=()=>{n.movement={type:"ingreso",amount:"",description:"",CategoryId:0,id:"",date:null},m.value="",n.isSaved=!1},m=D("");function v(l){const a=l.target.value.replace(/\D/g,"");if(a===""){m.value="";return}const p=parseInt(a,10);if(isNaN(p)){m.value="";return}m.value=x(p)}return{movementStore:n,submitForm:u,handleInput:v,valor:m,formatoMoneda:x,resetForm:s}},J={class:"max-w-xl mx-auto p-4 rounded-lg shadow-lg bg-slate-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"},Y={class:"text-2xl font-semibold mb-4"},j={class:"flex flex-col w-full"},z={class:"w-full flex gap-4"},K={class:"w-full"},Q={class:"w-full"},W={class:"w-full"},X={class:"flex gap-2"},de={__name:"Movement",setup(n){const u=R(),{isEdit:s=!1}=u.query,m=[{value:"ingreso",label:"Ingreso",color:"green",icon:Z},{value:"gasto",label:"Gasto",color:"red",icon:q}],{handleInput:v,formatoMoneda:l,movementStore:a,submitForm:p,valor:f,resetForm:b}=P();return E(async()=>{const c=JSON.parse(sessionStorage.getItem("data"));if(s&&c){sessionStorage.removeItem("data");const e=new Date(c.date),o=I=>I.toString().padStart(2,"0"),_=e.getFullYear(),S=o(e.getMonth()+1),M=o(e.getDate()),B=o(e.getHours()),k=o(e.getMinutes()),$=`${_}-${S}-${M}T${B}:${k}`;a.movement={...c,date:$},f.value=l(c.amount)}}),(c,e)=>(h(),w("div",J,[r("h2",Y,y(t(s)?"Editar":"Registrar")+" Movimiento",1),r("form",{onSubmit:e[5]||(e[5]=A(o=>t(p)(t(s)),["prevent"])),class:"flex flex-col gap-4 items-end",autocomplete:"off"},[F(r("div",j,[e[6]||(e[6]=r("label",{for:"createdAt"},"Fecha",-1)),i(g,{id:"createdAt",type:"datetime-local",modelValue:t(a).movement.date,"onUpdate:modelValue":e[0]||(e[0]=o=>t(a).movement.date=o)},null,8,["modelValue"])],512),[[N,t(s)]]),r("div",z,[i(T,{modelValue:t(a).movement.type,"onUpdate:modelValue":e[1]||(e[1]=o=>t(a).movement.type=o),options:m},null,8,["modelValue"])]),r("div",K,[i(L,{modelValue:t(a).movement.CategoryId,"onUpdate:modelValue":e[2]||(e[2]=o=>t(a).movement.CategoryId=o),type:t(a).movement.type},null,8,["modelValue","type"])]),r("div",Q,[e[7]||(e[7]=r("label",{for:"amount",class:"block text-gray-700 dark:text-gray-300"},"Monto",-1)),i(g,{type:"tel",id:"amount",modelValue:t(f),"onUpdate:modelValue":e[3]||(e[3]=o=>U(f)?f.value=o:null),required:"",onInput:t(v)},null,8,["modelValue","onInput"])]),r("div",W,[e[8]||(e[8]=r("label",{for:"description",class:"block text-gray-700 dark:text-gray-300"},"Descripción",-1)),i(g,{id:"description",modelValue:t(a).movement.description,"onUpdate:modelValue":e[4]||(e[4]=o=>t(a).movement.description=o)},null,8,["modelValue"])]),r("div",X,[i(V,{type:"submit",class:"flex gap-2 items-center"},{default:C(()=>[r("span",null,y(t(s)?"Editar":"Crear")+" Movimiento",1),i(t(G),{class:"w-5 inline"})]),_:1}),i(V,{color:"danger",onClick:t(b),title:"Limpiar Formulario"},{default:C(()=>[i(t(O),{class:"w-5 h-5"})]),_:1},8,["onClick"])])],32)]))}};export{de as default};
