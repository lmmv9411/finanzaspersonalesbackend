import{r as c,k as _,d as M,x as v,c as m,o as h,a as e,b as f,e as C,v as k,u,y as B,F as w,z as $,w as D,n as y,t as p}from"./index-BmVc9umw.js";import{S as i,M as E,_ as A}from"./MovementForm-DPVTSa25.js";const S=()=>{const r=c([]),s=c(""),l=c(""),d=c(""),n=async()=>{try{const a=await v.get(`/movements/date?startDate=${l.value}&endDate=${d.value}`);r.value=a.data}catch(a){console.error("Error al cargar movimientos",a)}},x=async a=>{if(!(await i.fire({title:"Eliminar Movimiento?",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){i.fire({title:"No se eliminó!",icon:"info",timer:2e3,theme:"auto",toast:!0,position:"top",showConfirmButton:!1,timerProgressBar:!0});return}i.fire({title:"Eliminando...",allowOutsideClick:!1,didOpen:()=>{i.showLoading()}});try{await v.delete(`/movements/${a}`),r.value=r.value.filter(t=>t.id!==a),i.fire({title:"Movimiento Eliminado",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"})}catch(t){console.error("Error al eliminar movimiento",t),i.fire({title:"Error al eliminar movimiento",icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"})}},g=function(){const a=new Date,o=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0");l.value=`${o}-${t}-01`,d.value=new Date(o,t,0).toISOString().split("T")[0],s.value=`${o}-${t}`};return _(s,a=>{const[o,t]=a.split("-");l.value=`${o}-${t}-01 00:00:00`,d.value=new Date(o,t,0).toISOString().split("T")[0]+" 23:59:59",n()}),M(()=>{g(),n()}),{movements:r,fetchMovements:n,selectedMonth:s,deleteMovement:x}};function F(r,s){return h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M13.488 2.513a1.75 1.75 0 0 0-2.475 0L6.75 6.774a2.75 2.75 0 0 0-.596.892l-.848 2.047a.75.75 0 0 0 .98.98l2.047-.848a2.75 2.75 0 0 0 .892-.596l4.261-4.262a1.75 1.75 0 0 0 0-2.474Z"}),e("path",{d:"M4.75 3.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V9A.75.75 0 0 1 14 9v2.25A2.75 2.75 0 0 1 11.25 14h-6.5A2.75 2.75 0 0 1 2 11.25v-6.5A2.75 2.75 0 0 1 4.75 2H7a.75.75 0 0 1 0 1.5H4.75Z"})])}function O(r,s){return h(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])}const T={class:"shadow-md p-2 rounded dark:bg-gray-800 bg-slate-100 flex gap-2 dark:text-gray-300 items-start sm:flex-row sm:items-end sm:w-fit m-auto flex-wrap"},V={class:"flex-1"},Z={class:"w-full max-w-4xl mx-auto p-4 overflow-x-auto"},H={class:"dark:text-white w-full table-auto border-collapse whitespace-nowrap"},L={class:"px-4 py-2"},N={class:"px-4 py-2"},P={class:"px-4 py-2"},I={class:"px-4 py-2"},z={class:"px-4 py-2 flex gap-2 justify-center"},R=["onClick"],j=["onClick"],q={__name:"Movements",setup(r){const s=c(!1),l=c({}),d=a=>{s.value=!0,l.value=a},{selectedMonth:n,movements:x,deleteMovement:g}=S();return(a,o)=>(h(),m(w,null,[o[4]||(o[4]=e("h2",{class:"mx-auto dark:text-white w-fit text-2xl font-semibold mt-4"},"Movimientos Registrados",-1)),e("div",T,[e("div",V,[o[2]||(o[2]=e("label",{for:"selectedMonth",class:"block text-gray-700 dark:text-gray-300"},"Filtrar Mes",-1)),C(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>B(n)?n.value=t:null),type:"month",id:"selectedMonth",class:"p-2 border border-gray-300 dark:bg-gray-900 dark:border-gray-700 border-2 focus:border-gray-300 focus:outline-none focus:border-gray-500 transition-colors duration-300 rounded"},null,512),[[k,u(n)]])])]),e("div",Z,[e("table",H,[o[3]||(o[3]=e("thead",null,[e("tr",{class:"border-b border-gray-400"},[e("th",{class:"px-4 py-2"},"Tipo"),e("th",{class:"px-4 py-2"},"Monto"),e("th",{class:"px-4 py-2"},"Descripción"),e("th",{class:"px-4 py-2"},"Categoría"),e("th",{class:"px-4 py-2"},"Fecha"),e("th",{class:"px-4 py-2"},"Acciones")])],-1)),e("tbody",null,[(h(!0),m(w,null,$(u(x),t=>(h(),m("tr",{key:t.id,class:"border-b border-gray-300"},[e("td",L,[e("span",{class:y(["font-bold",{"text-green-600":t.type==="ingreso","text-red-600":t.type!=="ingreso"}])},p(t.type),3)]),e("td",{class:y(["px-4 py-2",{"text-green-600":t.type==="ingreso","text-red-600":t.type!=="ingreso"}])},p(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(t.type==="gasto"?t.amount*-1:t.amount)),3),e("td",N,p(t.description),1),e("td",P,p(t.Category.name),1),e("td",I,p(new Date(t.createdAt).toLocaleString()),1),e("td",z,[e("button",{onClick:b=>d(t),class:"text-blue-500 hover:text-blue-700 cursor-pointer",title:"Editar movimiento"},[f(u(F),{class:"h-5 w-5"})],8,R),e("button",{onClick:b=>u(g)(t.id),class:"text-red-500 hover:text-red-700 ml-2 cursor-pointer",title:"Eliminar movimiento"},[f(u(O),{class:"h-5 w-5"})],8,j)])]))),128))])])]),f(E,{visible:s.value,onClose:o[1]||(o[1]=t=>s.value=!1)},{default:D(()=>[f(A,{isEdit:"true",data:l.value},null,8,["data"])]),_:1},8,["visible"])],64))}};export{q as default};
