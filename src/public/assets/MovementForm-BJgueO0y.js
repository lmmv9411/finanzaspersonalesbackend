import{c as f,o as v,a as r,L as _,r as g,x as w,i as E,k as u,f as p,w as x,J as $,M as k,N as j,T as R,G as T,d as C,S as h,l as B,b as q,n as y,t as b,F as Z,g as F,O as P,h as U,C as A,j as H,P as z,Q as K,I as Y}from"./index-BnwtM_X7.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as N,g as D}from"./icons-BQcnJwvV.js";import{I as V}from"./iconify-BUfL6Ga_.js";import{_ as I}from"./BaseButton-BhkkLOZw.js";import{_ as M}from"./BaseInput-CEAZr8wM.js";function J(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v16.19l6.22-6.22a.75.75 0 1 1 1.06 1.06l-7.5 7.5a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 1 1 1.06-1.06l6.22 6.22V3a.75.75 0 0 1 .75-.75Z","clip-rule":"evenodd"})])}function Ee(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M1.72 5.47a.75.75 0 0 1 1.06 0L9 11.69l3.756-3.756a.75.75 0 0 1 .985-.066 12.698 12.698 0 0 1 4.575 6.832l.308 1.149 2.277-3.943a.75.75 0 1 1 1.299.75l-3.182 5.51a.75.75 0 0 1-1.025.275l-5.511-3.181a.75.75 0 0 1 .75-1.3l3.943 2.277-.308-1.149a11.194 11.194 0 0 0-3.528-5.617l-3.809 3.81a.75.75 0 0 1-1.06 0L1.72 6.53a.75.75 0 0 1 0-1.061Z","clip-rule":"evenodd"})])}function Re(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M15.22 6.268a.75.75 0 0 1 .968-.431l5.942 2.28a.75.75 0 0 1 .431.97l-2.28 5.94a.75.75 0 1 1-1.4-.537l1.63-4.251-1.086.484a11.2 11.2 0 0 0-5.45 5.173.75.75 0 0 1-1.199.19L9 12.312l-6.22 6.22a.75.75 0 0 1-1.06-1.061l6.75-6.75a.75.75 0 0 1 1.06 0l3.606 3.606a12.695 12.695 0 0 1 5.68-4.974l1.086-.483-4.251-1.632a.75.75 0 0 1-.432-.97Z","clip-rule":"evenodd"})])}function Q(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z","clip-rule":"evenodd"})])}function W(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z","clip-rule":"evenodd"})])}function Te(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{d:"M10.464 8.746c.227-.18.497-.311.786-.394v2.795a2.252 2.252 0 0 1-.786-.393c-.394-.313-.546-.681-.546-1.004 0-.323.152-.691.546-1.004ZM12.75 15.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991 0 .305-.152.671-.579.991a2.534 2.534 0 0 1-.921.42Z"}),r("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v.816a3.836 3.836 0 0 0-1.72.756c-.712.566-1.112 1.35-1.112 2.178 0 .829.4 1.612 1.113 2.178.502.4 1.102.647 1.719.756v2.978a2.536 2.536 0 0 1-.921-.421l-.879-.66a.75.75 0 0 0-.9 1.2l.879.66c.533.4 1.169.645 1.821.75V18a.75.75 0 0 0 1.5 0v-.81a4.124 4.124 0 0 0 1.821-.749c.745-.559 1.179-1.344 1.179-2.191 0-.847-.434-1.632-1.179-2.191a4.122 4.122 0 0 0-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75 0 0 0 .933-1.175l-.415-.33a3.836 3.836 0 0 0-1.719-.755V6Z","clip-rule":"evenodd"})])}const G=_("modal",()=>{const e=g(!1),t=g(!1);return w(t,s=>{s&&setTimeout(()=>e.value=!0,150)}),w(e,s=>{s||setTimeout(()=>t.value=!1,300)}),{isRendered:e,showModal:t}}),X={class:"bg-slate-100 dark:bg-gray-900 p-4 rounded-lg shadow-xl w-90"},ee={__name:"Modal",setup(e){const t=G(),s=()=>t.isRendered=!1;return(m,d)=>u(t).showModal?(v(),f("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",onClick:T(s,["self"])},[p(R,{name:"slide-down"},{default:x(()=>[$(r("div",X,[j(m.$slots,"default",{},void 0,!0)],512),[[k,u(t).isRendered]])]),_:3})])):E("",!0)}},Ze=S(ee,[["__scopeId","data-v-fae993be"]]);function te(e,t){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[r("path",{"fill-rule":"evenodd",d:"M10.47 2.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H5.75a.75.75 0 0 1 0-1.5h5.69l-.97-.97a.75.75 0 0 1 0-1.06Zm-4.94 6a.75.75 0 0 1 0 1.06l-.97.97h5.69a.75.75 0 0 1 0 1.5H4.56l.97.97a.75.75 0 1 1-1.06 1.06l-2.25-2.25a.75.75 0 0 1 0-1.06l2.25-2.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}const L=_("balance",()=>{const e=g(""),t=g(""),s=g({totalIngreso:0,totalGasto:0,balance:0}),d=g(function(){const i=new Date,l=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0");return e.value=`${l}-${o}-01 00:00:00`,t.value=new Date(l,o,0).toISOString().split("T")[0]+" 23:59:59",`${l}-${o}`}());w(d,i=>{const[l,o]=i.split("-");e.value=`${l}-${o}-01 00:00:00`,t.value=new Date(l,o,0).toISOString().split("T")[0]+" 23:59:59"}),w([e,t],async()=>await n());const n=async()=>{try{const i=await C.get(`/movements/balance?startDate=${e.value}&endDate=${t.value}`);s.value=i.data}catch(i){console.error("Error al obtener el balance:",i),h.fire({title:"Error al obtener balance",icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}};return{selectedMonth:d,startDate:e,endDate:t,balance:s,fetchBalance:n}}),ae=_("graph",()=>{const e=L(),t=g({labels:[],datasets:[{label:"total",data:[],backgroundColor:["#60a5fa","#f87171","#34d399","#fbbf24","#a78bfa","#fb7185","#facc15","#38bdf8"]}]}),s=g({labels:[],datasets:[{label:"total",data:[],backgroundColor:["#60a5fa","#f87171","#34d399","#fbbf24","#a78bfa","#fb7185","#facc15","#38bdf8"]}]}),m=g(0),d=g(1),n=async()=>{const i=e.startDate,l=e.endDate;try{const o=await C.get(`/stats/totalByCategory?startDate=${i}&endDate=${l}`),{data:a}=o;s.value.labels=a.totalGastoByCategory.map(c=>c.Category.name),s.value.datasets[0].data=a.totalGastoByCategory.map(c=>Number(c.total)),t.value.labels=a.totalIngresoByCategory.map(c=>c.Category.name),t.value.datasets[0].data=a.totalIngresoByCategory.map(c=>Number(c.total)),m.value+=1,d.value+=1}catch(o){console.error("Error al cargar datos del gráfico:",o)}};return w(()=>[e.startDate,e.endDate],()=>n()),{chartDataIngreso:t,chartDataGasto:s,getTotalByCategory:n,chartKeyA:m,chartKeyB:d}}),oe=_("movement",()=>{const e=L(),t=ae(),s=g(!1),m=g({});return{saveMovement:async(n,i)=>{try{i?await C.put(`/movements/${n.id}`,n):await C.post("/movements",n),e.fetchBalance(),t.getTotalByCategory(e.startDate,e.endDate),s.value=!0,m.value=n}catch(l){s.value=!1,console.error("Error al registrar movimiento",l)}},isSaved:s,mov:m}}),re=()=>{const e=oe(),t=G(),s=g({type:"ingreso",amount:"",description:"",CategoryId:""}),m=async l=>{if(s.value.amount=n.value.replace(/\D/g,""),l&&!(await h.fire({title:"¿Desea Editar Registro?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, Editar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){t.showModal=!1,d(),h.fire({title:"Edicion Cancelada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"});return}h.fire({title:l?"Editando":"Guardando...",allowOutsideClick:!1,didOpen:()=>{h.showLoading()},theme:"auto"}),await e.saveMovement(s.value,l),h.close(),t.isRendered=!1,e.isSaved?h.fire({title:`Movimiento ${l?"Editado":"Registrado"}`,icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"}):h.fire({title:`Error al ${l?"Editar":"Registrar"} movimiento`,icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"}),t.showModal=!1,d()},d=()=>{s.value={type:"ingreso",amount:"",description:"",categoryId:"",id:""},e.isSaved=!1},n=g("");function i(l){const o=l.target.value.replace(/\D/g,"");if(o===""){n.value="";return}const a=parseInt(o,10);if(isNaN(a)){n.value="";return}n.value=B(a)}return{movement:s,submitForm:m,handleInput:i,valor:n,modalStore:t,formatoMoneda:B}},le={class:"w-full"},se={key:0,class:"flex items-center gap-2"},ne={key:1},de={class:"max-h-60 p-2 overflow-y-auto mt-2 rounded-md bg-white dark:bg-gray-800 shadow-lg border border-gray-200 dark:border-gray-700 max-h-60"},ie={class:"grid grid-cols-4 gap-3"},ce=["onClick"],ue={class:"text-xs mt-1 text-center"},me={__name:"CategorySelect",props:{movement:{required:!0,type:Object}},setup(e){const t=e,s=N(),m=g(!1),d=()=>m.value=!m.value,n=g(null),i=l=>{t.movement.CategoryId=l.id,n.value=l,m.value=!1};return w(t.movement,()=>{t.movement.CategoryId||(n.value=null)},{deep:!0}),q(()=>{const l=s.categories.find(o=>o.id===t.movement.CategoryId);l&&(n.value=l)}),(l,o)=>(v(),f("div",le,[r("button",{onClick:d,type:"button",class:"w-full flex items-center justify-between p-2 border border-gray-300 rounded-md shadow-sm dark:bg-gray-800 dark:border-gray-700 text-left"},[n.value?(v(),f("div",se,[r("div",{class:y([[u(D)(n.value.icon)],"rounded-full p-1 text-white text-lg"])},[p(u(V),{icon:n.value.icon,class:"w-5 h-5"},null,8,["icon"])],2),r("span",null,b(n.value.name),1)])):(v(),f("span",ne,"Selecciona Categoria")),p(u(W),{class:"w-5 h-5 text-gray-400"})]),p(R,{name:"slide-down"},{default:x(()=>[$(r("div",de,[r("div",ie,[(v(!0),f(Z,null,F(u(s).categories,a=>(v(),f("div",{key:a.id,onClick:c=>i(a),class:y(["flex p-2 flex-col items-center rounded-lg cursor-pointer transition-all",{"bg-primary-100 dark:bg-primary-900 border-2 border-gray-200 dark:border-gray-500":e.movement.CategoryId===a.id,"hover:bg-gray-200 dark:hover:bg-gray-700":e.movement.CategoryId!==a.id}])},[r("div",{class:y([[u(D)(a.icon)],"rounded-full p-1 text-white text-lg hover:scale-110 duration-200"])},[p(u(V),{icon:a.icon},null,8,["icon"])],2),r("span",ue,b(a.name),1)],10,ce))),128))])],512),[[k,m.value]])]),_:1})]))}},ve=S(me,[["__scopeId","data-v-25be6cd1"]]),fe={class:"flex gap-2"},ge=["value"],pe={__name:"RadioButton",props:{modelValue:{type:String,required:!0},options:{type:Array,required:!0,validator:e=>e.every(t=>typeof t=="object"&&"value"in t&&"label"in t&&"color"in t)}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,m=t,d=g(s.modelValue);w(()=>s.modelValue,i=>{d.value=i});const n=()=>{m("update:modelValue",d.value)};return(i,l)=>(v(),f("div",fe,[(v(!0),f(Z,null,F(e.options,o=>(v(),f("label",{key:o.value,class:"relative"},[$(r("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=a=>d.value=a),class:"absolute opacity-0 w-0 h-0",onChange:n},null,40,ge),[[P,d.value]]),r("span",{class:y(["inline-flex items-center px-4 py-2 rounded-xl border text-sm font-medium cursor-pointer transition-all duration-200",[d.value===o.value?`bg-${o.color}-100 border-2 border-${o.color}-300 text-${o.color}-700 dark:bg-${o.color}-900/30 dark:border-${o.color}-700 dark:text-${o.color}-300`:"border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800"]])},[o.icon?(v(),U(H(o.icon),{key:0,class:"w-4 h-4 mr-2"})):E("",!0),A(" "+b(o.label),1)],2)]))),128))]))}},he=S(pe,[["__scopeId","data-v-405845d4"]]),we={class:"mx-auto p-4 border border-gray-300 rounded-lg shadow-lg bg-slate-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"},be={class:"text-2xl font-semibold mb-4"},ye={class:"flex flex-col w-full"},xe={class:"w-full flex gap-4"},Ce={class:"w-full"},_e={class:"w-full"},$e={class:"w-full"},Me={class:"flex gap-2"},Fe={__name:"MovementForm",props:z(["isEdit","data"],{isEdit:!1}),setup(e){const t=[{value:"ingreso",label:"Ingreso",color:"green",icon:J},{value:"gasto",label:"Gasto",color:"red",icon:Q}],{handleInput:s,formatoMoneda:m,movement:d,submitForm:n,valor:i,modalStore:l}=re();return K(async()=>{if(e.isEdit&&e.data){const o=new Date(e.data.date),a=O=>O.toString().padStart(2,"0"),c=`${o.getFullYear()}-${a(o.getMonth()+1)}-${a(o.getDate())}T${a(o.getHours())}:${a(o.getMinutes())}`;d.value={...e.data,date:c},i.value=m(e.data.amount),await N().getCategories()}}),(o,a)=>(v(),f("div",we,[r("h2",be,b(e.isEdit?"Editar":"Registrar")+" Movimiento",1),r("form",{onSubmit:a[5]||(a[5]=T(c=>u(n)(e.isEdit),["prevent"])),class:"flex flex-col gap-4 items-end",autocomplete:"off"},[$(r("div",ye,[a[6]||(a[6]=r("label",{for:"createdAt"},"Fecha",-1)),p(M,{id:"createdAt",type:"datetime-local",modelValue:u(d).date,"onUpdate:modelValue":a[0]||(a[0]=c=>u(d).date=c)},null,8,["modelValue"])],512),[[k,e.isEdit]]),r("div",xe,[p(he,{modelValue:u(d).type,"onUpdate:modelValue":a[1]||(a[1]=c=>u(d).type=c),options:t},null,8,["modelValue"])]),r("div",Ce,[p(ve,{movement:u(d)},null,8,["movement"])]),r("div",_e,[a[7]||(a[7]=r("label",{for:"amount",class:"block text-gray-700 dark:text-gray-300"},"Monto",-1)),p(M,{type:"tel",id:"amount",modelValue:u(i),"onUpdate:modelValue":a[2]||(a[2]=c=>Y(i)?i.value=c:null),required:"",onInput:u(s)},null,8,["modelValue","onInput"])]),r("div",$e,[a[8]||(a[8]=r("label",{for:"description",class:"block text-gray-700 dark:text-gray-300"},"Descripción",-1)),p(M,{id:"description",modelValue:u(d).description,"onUpdate:modelValue":a[3]||(a[3]=c=>u(d).description=c),modelModifiers:{trim:!0}},null,8,["modelValue"])]),r("div",Me,[p(I,{type:"submit",class:"flex gap-2 items-center"},{default:x(()=>[r("span",null,b(e.isEdit?"Editar":"Crear")+" Movimiento",1),p(u(te),{class:"w-5 inline"})]),_:1}),p(I,{color:"danger",onClick:a[4]||(a[4]=c=>u(l).isRendered=!1)},{default:x(()=>a[9]||(a[9]=[r("span",null,"Cerrar",-1)])),_:1})])],32)]))}};export{ve as C,Ze as M,Fe as _,L as a,Ee as b,Te as c,ae as d,oe as e,Re as r,G as u};
