import{c as h,o as x,a,h as R,l as y,S as u,H as E,A as F,I as A,t as C,u as t,E as H,J as N,b as i,D as T,w as V,v as U}from"./index-CGu822fW.js";import{u as Z,C as q}from"./movementStore-BT5acqXQ.js";import{_ as b}from"./BaseButton-mp_JG_GH.js";import{_ as w}from"./BaseInput-B1xAGFec.js";import{R as L,r as O,a as P}from"./RadioButton-DKaW1--S.js";import"./iconify-B3NB4TUO.js";import"./categoriesStore-CNJgLoXL.js";import"./icons-BjrsL8W4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./graphStore-Dpde9L3_.js";function G(s,m){return x(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M10.47 2.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H5.75a.75.75 0 0 1 0-1.5h5.69l-.97-.97a.75.75 0 0 1 0-1.06Zm-4.94 6a.75.75 0 0 1 0 1.06l-.97.97h5.69a.75.75 0 0 1 0 1.5H4.56l.97.97a.75.75 0 1 1-1.06 1.06l-2.25-2.25a.75.75 0 0 1 0-1.06l2.25-2.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function J(s,m){return x(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z","clip-rule":"evenodd"})])}const Y=()=>{const s=Z(),m=async r=>{if(s.movement.amount=d.value.replace(/\D/g,""),r&&!(await u.fire({title:"¿Desea Editar Registro?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, Editar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){n(),u.fire({title:"Edicion Cancelada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"});return}u.fire({title:r?"Editando":"Guardando...",allowOutsideClick:!1,didOpen:()=>{u.showLoading()},theme:"auto"}),await s.saveMovement(r),u.close(),s.isSaved?u.fire({title:`Movimiento ${r?"Editado":"Registrado"}`,icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"}):u.fire({title:`Error al ${r?"Editar":"Registrar"} movimiento`,icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"}),r&&history.back(),n()},n=()=>{s.movement={type:"ingreso",amount:"",description:"",CategoryId:0,id:"",date:null},d.value="",s.isSaved=!1},d=R("");function g(r){const c=r.target.value.replace(/\D/g,"");if(c===""){d.value="";return}const p=parseInt(c,10);if(isNaN(p)){d.value="";return}d.value=y(p)}return{movementStore:s,submitForm:m,handleInput:g,valor:d,formatoMoneda:y,resetForm:n}},j={class:"max-w-xl mx-auto p-4 rounded-lg shadow-lg bg-slate-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"},z={class:"text-2xl font-semibold mb-4"},K={class:"flex flex-col w-full"},Q={class:"w-full flex gap-4"},W={class:"w-full"},X={class:"w-full"},ee={class:"w-full"},te={class:"flex gap-2"},ce={__name:"Movement",setup(s){const m=E(),{isEdit:n=!1}=m.query,d=[{value:"ingreso",label:"Ingreso",color:"green",icon:O},{value:"gasto",label:"Gasto",color:"red",icon:P}],{handleInput:g,formatoMoneda:r,movementStore:c,submitForm:p,valor:v,resetForm:_}=Y(),{movement:l}=F(c);return A(async()=>{const f=JSON.parse(sessionStorage.getItem("data"));if(n&&f){sessionStorage.removeItem("data");const e=new Date(f.date),o=D=>D.toString().padStart(2,"0"),S=e.getFullYear(),B=o(e.getMonth()+1),M=o(e.getDate()),k=o(e.getHours()),$=o(e.getMinutes()),I=`${S}-${B}-${M}T${k}:${$}`;l.value={...f,date:I},v.value=r(f.amount)}}),(f,e)=>(x(),h("div",j,[a("h2",z,C(t(n)?"Editar":"Registrar")+" Movimiento",1),a("form",{onSubmit:e[5]||(e[5]=U(o=>t(p)(t(n)),["prevent"])),class:"flex flex-col gap-4 items-end",autocomplete:"off"},[H(a("div",K,[e[6]||(e[6]=a("label",{for:"createdAt"},"Fecha",-1)),i(w,{id:"createdAt",type:"datetime-local",modelValue:t(l).date,"onUpdate:modelValue":e[0]||(e[0]=o=>t(l).date=o)},null,8,["modelValue"])],512),[[N,t(n)]]),a("div",Q,[i(L,{modelValue:t(l).type,"onUpdate:modelValue":e[1]||(e[1]=o=>t(l).type=o),options:d},null,8,["modelValue"])]),a("div",W,[i(q,{modelValue:t(l).CategoryId,"onUpdate:modelValue":e[2]||(e[2]=o=>t(l).CategoryId=o),type:t(l).type},null,8,["modelValue","type"])]),a("div",X,[e[7]||(e[7]=a("label",{for:"amount",class:"block text-gray-700 dark:text-gray-300"},"Monto",-1)),i(w,{type:"tel",id:"amount",modelValue:t(v),"onUpdate:modelValue":e[3]||(e[3]=o=>T(v)?v.value=o:null),required:"",onInput:t(g)},null,8,["modelValue","onInput"])]),a("div",ee,[e[8]||(e[8]=a("label",{for:"description",class:"block text-gray-700 dark:text-gray-300"},"Descripción",-1)),i(w,{id:"description",modelValue:t(l).description,"onUpdate:modelValue":e[4]||(e[4]=o=>t(l).description=o)},null,8,["modelValue"])]),a("div",te,[i(b,{type:"submit",class:"flex gap-2 items-center"},{default:V(()=>[a("span",null,C(t(n)?"Editar":"Crear")+" Movimiento",1),i(t(G),{class:"w-5 inline"})]),_:1}),i(b,{color:"danger",onClick:t(_),title:"Limpiar Formulario"},{default:V(()=>[i(t(J),{class:"w-5 h-5"})]),_:1},8,["onClick"])])],32)]))}};export{ce as default};
