import{c as y,o as h,a as t,h as S,q as b,p as k,I,A as M,J as D,t as V,u as o,E as $,K as E,b as d,D as F,w as _,z as R}from"./index-BIQqEOZA.js";import{u as B,C as N}from"./movementStore-Bc2uukLE.js";import{_ as C}from"./BaseButton-C-1Q9ZVJ.js";import{_ as x}from"./BaseInput-BAsoIT1y.js";import{R as A,r as U,a as L}from"./RadioButton-B88ftpv5.js";import{u as Z}from"./useDates-B6TuTcoJ.js";import"./iconify-Cw4JIRDF.js";import"./categoriesStore-C4UhHkgE.js";import"./icons-BjrsL8W4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function q(n,l){return h(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M10.47 2.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H5.75a.75.75 0 0 1 0-1.5h5.69l-.97-.97a.75.75 0 0 1 0-1.06Zm-4.94 6a.75.75 0 0 1 0 1.06l-.97.97h5.69a.75.75 0 0 1 0 1.5H4.56l.97.97a.75.75 0 1 1-1.06 1.06l-2.25-2.25a.75.75 0 0 1 0-1.06l2.25-2.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function H(n,l){return h(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z","clip-rule":"evenodd"})])}const T=()=>{const n=S(""),l=B(),{showError:m,showConfirm:p,showInfo:f,showLoading:v,showSuccess:g,close:w}=k(),u=async r=>{if(l.movement.amount=n.value.replace(/\D/g,""),r&&!(await p("¿Desea Editar Registro?","Sí, Editar","Cancelar")).isConfirmed){c(),f("Edición Cancelada"),history.back();return}v(r?"Editando":"Guardando..."),await l.saveMovement(r),w(),l.isSaved?g(`Movimiento ${r?"editado":"registrado"} correctamente`,!0):m(`Error al ${r?"editar":"registrar"} movimiento`,!0),r&&history.back(),c()},c=()=>{l.movement={type:"ingreso",amount:"",description:"",CategoryId:0,id:"",date:null},n.value="",l.isSaved=!1};function a(r){const i=r.target.value.replace(/\D/g,"");if(i===""){n.value="";return}const e=parseInt(i,10);if(isNaN(e)){n.value="";return}n.value=b(e)}return{movementStore:l,submitForm:u,handleInput:a,valor:n,formatoMoneda:b,resetForm:c}},G={class:"mt-4 max-w-xl mx-4 sm:mx-auto p-4 rounded-lg shadow-lg bg-slate-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"},J={class:"text-2xl font-semibold mb-4"},z={class:"flex flex-col w-full"},K={class:"w-full flex gap-4"},O={class:"w-full"},j={class:"w-full"},P={class:"w-full"},Q={class:"flex gap-2"},ne={__name:"Movement",setup(n){const l=I(),{isEdit:m=!1}=l.query,p=[{value:"ingreso",label:"Ingreso",color:"green",icon:U},{value:"gasto",label:"Gasto",color:"red",icon:L}],{handleInput:f,formatoMoneda:v,movementStore:g,submitForm:w,valor:u,resetForm:c}=T(),{movement:a}=M(g),{toLocalDateTime:r}=Z();return D(async()=>{const i=JSON.parse(sessionStorage.getItem("data"));if(m&&i){sessionStorage.removeItem("data");const e=r(i.date);a.value={...i,date:e},u.value=v(i.amount)}}),(i,e)=>(h(),y("div",G,[t("h2",J,V(o(m)?"Editar":"Registrar")+" Movimiento",1),t("form",{onSubmit:e[5]||(e[5]=R(s=>o(w)(o(m)),["prevent"])),class:"flex flex-col gap-4 items-end",autocomplete:"off"},[$(t("div",z,[e[6]||(e[6]=t("label",{for:"createdAt"},"Fecha",-1)),d(x,{id:"createdAt",type:"datetime-local",modelValue:o(a).date,"onUpdate:modelValue":e[0]||(e[0]=s=>o(a).date=s)},null,8,["modelValue"])],512),[[E,o(m)]]),t("div",K,[d(A,{modelValue:o(a).type,"onUpdate:modelValue":e[1]||(e[1]=s=>o(a).type=s),options:p},null,8,["modelValue"])]),t("div",O,[d(N,{modelValue:o(a).CategoryId,"onUpdate:modelValue":e[2]||(e[2]=s=>o(a).CategoryId=s),type:o(a).type},null,8,["modelValue","type"])]),t("div",j,[e[7]||(e[7]=t("label",{for:"amount",class:"block text-gray-700 dark:text-gray-300"},"Monto",-1)),d(x,{type:"tel",id:"amount",modelValue:o(u),"onUpdate:modelValue":e[3]||(e[3]=s=>F(u)?u.value=s:null),required:"",onInput:o(f)},null,8,["modelValue","onInput"])]),t("div",P,[e[8]||(e[8]=t("label",{for:"description",class:"block text-gray-700 dark:text-gray-300"},"Descripción",-1)),d(x,{id:"description",modelValue:o(a).description,"onUpdate:modelValue":e[4]||(e[4]=s=>o(a).description=s)},null,8,["modelValue"])]),t("div",Q,[d(C,{type:"submit",class:"flex gap-2 items-center"},{default:_(()=>[t("span",null,V(o(m)?"Editar":"Crear")+" Movimiento",1),d(o(q),{class:"w-5 inline"})]),_:1}),d(C,{color:"danger",onClick:o(c),title:"Limpiar Formulario"},{default:_(()=>[d(o(H),{class:"w-5 h-5"})]),_:1},8,["onClick"])])],32)]))}};export{ne as default};
