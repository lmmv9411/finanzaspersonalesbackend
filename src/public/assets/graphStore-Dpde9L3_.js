import{j as f,h as n,y as g,x as y,z as i}from"./index-CGu822fW.js";const h=t=>f.get("/movements/balance",{params:t});function m(){const t=n(""),r=n(""),e=()=>{const a=new Date,u=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0");return`${u}-${s}`},o=n(e()),c=a=>{if(!a)return;const[u,s]=a.split("-");t.value=`${u}-${s}-01 00:00:00`,r.value=new Date(u,s,0).toISOString().split("T")[0]+" 23:59:59"},l=()=>{o.value=e()};return g(o,c,{immediate:!0}),{selectedMonth:o,startDate:t,endDate:r,resetToCurrentMonth:l}}const D=y("balance",()=>{const{showError:t}=i(),{selectedMonth:r,startDate:e,endDate:o}=m(),c=n({totalIngreso:0,totalGasto:0,balance:0}),l=async()=>{try{const a=await h({startDate:e.value,endDate:o.value});c.value=a.data}catch(a){console.error("Error al obtener el balance:",a),t("Error al obtener balance")}};return g([e,o],l,{immediate:!0}),{selectedMonth:r,startDate:e,endDate:o,balance:c,fetchBalance:l}}),v=y("graph",()=>{const t=D(),r=n({labels:[],datasets:[{label:"total",data:[],backgroundColor:["#60a5fa","#f87171","#34d399","#fbbf24","#a78bfa","#fb7185","#facc15","#38bdf8"]}]}),e=n({labels:[],datasets:[{label:"total",data:[],backgroundColor:["#60a5fa","#f87171","#34d399","#fbbf24","#a78bfa","#fb7185","#facc15","#38bdf8"]}]}),o=n(0),c=n(1),l=async()=>{const a=t.startDate,u=t.endDate;try{const s=await f.get(`/stats/totalByCategory?startDate=${a}&endDate=${u}`),{data:b}=s;e.value.labels=b.totalGastoByCategory.map(d=>d.Category.name),e.value.datasets[0].data=b.totalGastoByCategory.map(d=>Number(d.total)),r.value.labels=b.totalIngresoByCategory.map(d=>d.Category.name),r.value.datasets[0].data=b.totalIngresoByCategory.map(d=>Number(d.total)),o.value+=1,c.value+=1}catch(s){console.error("Error al cargar datos del grÃ¡fico:",s)}};return g(()=>[t.startDate,t.endDate],()=>l()),{chartDataIngreso:r,chartDataGasto:e,getTotalByCategory:l,chartKeyA:o,chartKeyB:c}});export{v as a,m as b,D as u};
