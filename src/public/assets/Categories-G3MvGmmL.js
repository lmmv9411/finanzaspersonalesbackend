import{r as w,d as k,m as p,c as C,a as r,D as E,b as u,x as S,u as s,p as N,w as x,B as V,F as y,y as $,o as h,J as b,t as v}from"./index-6yIVpIIz.js";import{S as o,_ as U,a as _}from"./BaseInput-HaCwFjNR.js";import{u as B}from"./categoriesStore-Crxyu36l.js";import{a as O,r as P}from"./TrashIcon-CkBttpBc.js";function D(){const i=w(""),l=w(!1);let n=null;const a=B(),d=async()=>{if(l.value){f(n);return}try{if(i.value===""){o.fire({title:"Nombre Vacío",icon:"error",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"});return}o.fire({title:"Creando...",allowOutsideClick:!1,didOpen:()=>{o.showLoading()},theme:"auto"}),await p.post("/categories",{name:i.value}),o.fire({title:"Categoria Creada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"}),i.value="",a.getCategories()}catch(e){console.error("Error creating category:",e),o.fire({title:"Error al crear categoria",text:e.response.data.error,icon:"error",timer:3e3,showConfirmButton:!1,theme:"auto"})}},m=async e=>{try{if(!(await o.fire({title:"Eliminar Categoria?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){o.fire({title:"No se eliminó!",icon:"info",timer:2e3,theme:"auto",toast:!0,position:"top",showConfirmButton:!1,timerProgressBar:!0});return}o.fire({title:"Eliminando...",allowOutsideClick:!1,didOpen:()=>{o.showLoading()},theme:"auto"}),await p.delete(`/categories/${e}`),a.getCategories(),o.fire({title:"Categoria Eliminada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"})}catch(t){console.error("Error deleting category:",t),o.fire({title:"Error al eliminar categoria",text:t.response.data.error,icon:"error",timer:3e3,showConfirmButton:!1,theme:"auto"})}},c=e=>{const t=a.categories.findIndex(g=>g.id===e);t!==-1&&(i.value=a.categories[t].name,a.categories.splice(t,1),l.value=!0,n=e)},f=async e=>{try{const t=await p.put(`/categories/${e}`,{name:i.value});console.log("Category updated:",t.data),a.getCategories(),l.value=!1,n=null,i.value=""}catch(t){console.error("Error updating category:",t)}};return k(async()=>a.getCategories()),{name:i,createCategory:d,deleteCategory:m,updateCategory:f,onUpdateCategory:c,isUpdate:l}}const L={class:"flex flex-col gap-8"},M={class:"flex gap-2"},T={class:"dark:text-white w-fit table-auto border-collapse whitespace-nowrap m-auto overflow-auto text-xl"},A={class:"p-4"},F={class:"p-4 flex gap-4"},q=["onClick"],z=["onClick"],H={__name:"Categories",setup(i){const l=B(),{name:n,createCategory:a,deleteCategory:d,onUpdateCategory:m,isUpdate:c}=D();return(f,e)=>(h(),C(y,null,[e[4]||(e[4]=r("h1",{class:"dark:text-white font-bold text-xl"},"Categorias",-1)),r("div",L,[r("form",{onSubmit:e[1]||(e[1]=E((...t)=>s(a)&&s(a)(...t),["prevent"])),class:"shadow-md p-2 rounded dark:bg-gray-800 bg-slate-100 flex gap-2 dark:text-gray-300 items-start w-fit m-auto"},[u(U,{modelValue:s(n),"onUpdate:modelValue":e[0]||(e[0]=t=>S(n)?n.value=t:null),modelModifiers:{trim:!0},placeholder:"Nombre de categoria"},null,8,["modelValue"]),r("div",M,[u(_,{type:"submit"},{default:x(()=>[b(v(s(c)?"Actualizar":"Crear"),1)]),_:1}),N(u(_,{type:"cancel",color:"danger"},{default:x(()=>e[2]||(e[2]=[b("Cancelar")])),_:1},512),[[V,s(c)]])])],32),r("table",T,[e[3]||(e[3]=r("thead",null,[r("tr",{class:"border-b border-gray-400"},[r("th",null,"Nombre"),r("th",null,"Acciones")])],-1)),r("tbody",null,[(h(!0),C(y,null,$(s(l).categories,t=>(h(),C("tr",{class:"border-b border-gray-300",key:t.id},[r("td",A,v(t.name),1),r("td",F,[r("button",{onClick:g=>s(d)(t.id),class:"text-red-500 hover:text-red-700 cursor-pointer",title:"Eliminar categoria"},[u(s(O),{class:"h-5 w-5"})],8,q),r("button",{onClick:g=>s(m)(t.id),class:"text-blue-500 hover:text-blue-700 cursor-pointer",title:"Editar categoria"},[u(s(P),{class:"h-5 w-5"})],8,z)])]))),128))])])])],64))}};export{H as default};
