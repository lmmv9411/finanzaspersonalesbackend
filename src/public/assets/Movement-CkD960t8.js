import{c as g,o as v,a,h as _,x as M,F as I,r as U,J as k,L as D,d as T,k as R,C as $,e as F,t as h,n as N,l as b,S as p,M as E,N as q,u as o,O as L,b as c,I as O,w as C,G as Z}from"./index-C6LpurIG.js";import{u as A,C as G}from"./movementStore-E73T9jzh.js";import{_ as V}from"./BaseButton-CWsAGAwr.js";import{_ as y}from"./BaseInput-DP8AbO3v.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as P}from"./categoriesStore--00gGrBo.js";import"./iconify-CjBp2mNT.js";import"./icons-BjrsL8W4.js";import"./graphStore-CZFusKuu.js";function J(l,n){return v(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v16.19l6.22-6.22a.75.75 0 1 1 1.06 1.06l-7.5 7.5a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 1 1 1.06-1.06l6.22 6.22V3a.75.75 0 0 1 .75-.75Z","clip-rule":"evenodd"})])}function j(l,n){return v(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z","clip-rule":"evenodd"})])}function z(l,n){return v(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M10.47 2.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H5.75a.75.75 0 0 1 0-1.5h5.69l-.97-.97a.75.75 0 0 1 0-1.06Zm-4.94 6a.75.75 0 0 1 0 1.06l-.97.97h5.69a.75.75 0 0 1 0 1.5H4.56l.97.97a.75.75 0 1 1-1.06 1.06l-2.25-2.25a.75.75 0 0 1 0-1.06l2.25-2.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}const Y={class:"flex gap-2"},K=["value"],Q={__name:"RadioButton",props:{modelValue:{type:String,required:!0},options:{type:Array,required:!0,validator:l=>l.every(n=>typeof n=="object"&&"value"in n&&"label"in n&&"color"in n)}},emits:["update:modelValue"],setup(l,{emit:n}){const i=l,u=n,m=_(i.modelValue);M(()=>i.modelValue,r=>{m.value=r});const d=()=>{u("update:modelValue",m.value)};return(r,f)=>(v(),g("div",Y,[(v(!0),g(I,null,U(l.options,t=>(v(),g("label",{key:t.value,class:"relative"},[k(a("input",{type:"radio",value:t.value,"onUpdate:modelValue":f[0]||(f[0]=w=>m.value=w),class:"absolute opacity-0 w-0 h-0",onChange:d},null,40,K),[[D,m.value]]),a("span",{class:N(["inline-flex items-center px-4 py-2 rounded-xl border text-sm font-medium cursor-pointer transition-all duration-200",[m.value===t.value?`bg-${t.color}-100 border-2 border-${t.color}-300 text-${t.color}-700 dark:bg-${t.color}-900/30 dark:border-${t.color}-700 dark:text-${t.color}-300`:"border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-gray-800"]])},[t.icon?(v(),T(F(t.icon),{key:0,class:"w-4 h-4 mr-2"})):R("",!0),$(" "+h(t.label),1)],2)]))),128))]))}},W=H(Q,[["__scopeId","data-v-405845d4"]]),X=()=>{const l=A(),n=async d=>{if(l.movement.amount=u.value.replace(/\D/g,""),d&&!(await p.fire({title:"¿Desea Editar Registro?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, Editar",cancelButtonText:"Cancelar",theme:"auto"})).isConfirmed){i(),p.fire({title:"Edicion Cancelada",icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"});return}p.fire({title:d?"Editando":"Guardando...",allowOutsideClick:!1,didOpen:()=>{p.showLoading()},theme:"auto"}),await l.saveMovement(d),p.close(),l.isSaved?p.fire({title:`Movimiento ${d?"Editado":"Registrado"}`,icon:"success",toast:!0,position:"top",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,theme:"auto"}):p.fire({title:`Error al ${d?"Editar":"Registrar"} movimiento`,icon:"error",toast:!0,position:"top",timer:3e3,showConfirmButton:!1,timerProgressBar:!0,theme:"auto"}),d&&history.back(),i()},i=()=>{l.movement={type:"ingreso",amount:"",description:"",CategoryId:0,id:"",date:null},u.value="",l.isSaved=!1},u=_("");function m(d){const r=d.target.value.replace(/\D/g,"");if(r===""){u.value="";return}const f=parseInt(r,10);if(isNaN(f)){u.value="";return}u.value=b(f)}return{movementStore:l,submitForm:n,handleInput:m,valor:u,formatoMoneda:b,resetForm:i}},ee={class:"max-w-xl mx-auto p-4 rounded-lg shadow-lg bg-slate-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"},te={class:"text-2xl font-semibold mb-4"},oe={class:"flex flex-col w-full"},ae={class:"w-full flex gap-4"},re={class:"w-full"},le={class:"w-full"},se={class:"w-full"},ne={class:"flex gap-2"},xe={__name:"Movement",setup(l){const n=E(),{isEdit:i=!1}=n.query,u=[{value:"ingreso",label:"Ingreso",color:"green",icon:J},{value:"gasto",label:"Gasto",color:"red",icon:j}],{handleInput:m,formatoMoneda:d,movementStore:r,submitForm:f,valor:t,resetForm:w}=X();return q(async()=>{const x=JSON.parse(sessionStorage.getItem("data"));if(i&&x){sessionStorage.removeItem("data");const e=new Date(x.date),s=B=>B.toString().padStart(2,"0"),S=`${e.getUTCFullYear()}-${s(e.getUTCMonth()+1)}-${s(e.getUTCDate())}T${s(e.getUTCHours())}:${s(e.getUTCMinutes())}`;r.movement={...x,date:S},t.value=d(x.amount)}await P().getCategories()}),(x,e)=>(v(),g("div",ee,[a("h2",te,h(o(i)?"Editar":"Registrar")+" Movimiento",1),a("form",{onSubmit:e[5]||(e[5]=Z(s=>o(f)(o(i)),["prevent"])),class:"flex flex-col gap-4 items-end",autocomplete:"off"},[k(a("div",oe,[e[6]||(e[6]=a("label",{for:"createdAt"},"Fecha",-1)),c(y,{id:"createdAt",type:"datetime-local",modelValue:o(r).movement.date,"onUpdate:modelValue":e[0]||(e[0]=s=>o(r).movement.date=s)},null,8,["modelValue"])],512),[[L,o(i)]]),a("div",ae,[c(W,{modelValue:o(r).movement.type,"onUpdate:modelValue":e[1]||(e[1]=s=>o(r).movement.type=s),options:u},null,8,["modelValue"])]),a("div",re,[c(G,{modelValue:o(r).movement.CategoryId,"onUpdate:modelValue":e[2]||(e[2]=s=>o(r).movement.CategoryId=s)},null,8,["modelValue"])]),a("div",le,[e[7]||(e[7]=a("label",{for:"amount",class:"block text-gray-700 dark:text-gray-300"},"Monto",-1)),c(y,{type:"tel",id:"amount",modelValue:o(t),"onUpdate:modelValue":e[3]||(e[3]=s=>O(t)?t.value=s:null),required:"",onInput:o(m)},null,8,["modelValue","onInput"])]),a("div",se,[e[8]||(e[8]=a("label",{for:"description",class:"block text-gray-700 dark:text-gray-300"},"Descripción",-1)),c(y,{id:"description",modelValue:o(r).movement.description,"onUpdate:modelValue":e[4]||(e[4]=s=>o(r).movement.description=s)},null,8,["modelValue"])]),a("div",ne,[c(V,{type:"submit",class:"flex gap-2 items-center"},{default:C(()=>[a("span",null,h(o(i)?"Editar":"Crear")+" Movimiento",1),c(o(z),{class:"w-5 inline"})]),_:1}),c(V,{color:"danger",onClick:o(w)},{default:C(()=>e[9]||(e[9]=[$("Limpiar")])),_:1},8,["onClick"])])],32)]))}};export{xe as default};
